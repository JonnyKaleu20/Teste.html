<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>ðŸ’Œ Cartinhas do Amor</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #ffe6e6;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 20px;
    }

    h1, h2, h3 {
      color: #cc0052;
    }

    button {
      background-color: #ff4d88;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      margin: 10px 0;
    }

    #formCartinha {
      background-color: #fff0f5;
      border-radius: 10px;
      padding: 20px;
      width: 90%;
      max-width: 600px;
      border: 2px solid #ff99cc;
    }

    textarea, input[type="text"], input[type="file"] {
      width: 100%;
      padding: 10px;
      border: 1px solid #ff4d88;
      border-radius: 5px;
      margin-bottom: 15px;
    }

    #cartinhasRecebidas {
      width: 90%;
      max-width: 600px;
      margin-top: 30px;
      background-color: white;
      padding: 15px;
      border-radius: 10px;
      border: 2px solid #ff4d88;
    }

    .cartinha {
      background-color: #fff0f5;
      border: 1px solid #ffcce0;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 15px;
    }
  </style>
</head>
<body>

  <h1>ðŸ’Œ Cartinhas do Amor</h1>

  <div id="formCartinha">
    <h2>Envie sua cartinha</h2>
    <form id="cartinhaForm">
      <textarea id="textoCartinha" placeholder="Digite sua cartinha..." rows="5"></textarea>
      <label>Ou envie um arquivo:
        <input type="file" id="arquivoCartinha" />
      </label>
      <input type="text" id="feedbackCartinha" placeholder="Deixe seu feedback (opcional)" />
      <button type="submit">Enviar Cartinha ðŸ’–</button>
    </form>
  </div>

  <h3>ðŸ“¬ Cartinhas Recebidas:</h3>
  <div id="cartinhasRecebidas"></div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-storage-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDY4GfPbpE0b8fz6ZfUOsitiuu2pUcVqRU",
      authDomain: "amors-18a20.firebaseapp.com",
      databaseURL: "https://amors-18a20-default-rtdb.firebaseio.com",
      projectId: "amors-18a20",
      storageBucket: "amors-18a20.appspot.com",
      messagingSenderId: "360392240276",
      appId: "1:360392240276:web:7910c99a560efc0c4b9881",
      measurementId: "G-TJZXHWD6MW"
    };

    firebase.initializeApp(firebaseConfig);

    const database = firebase.database();
    const storage = firebase.storage();

    const cartinhaForm = document.getElementById("cartinhaForm");
    const cartinhasDiv = document.getElementById("cartinhasRecebidas");

    cartinhaForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const texto = document.getElementById("textoCartinha").value.trim();
      const arquivo = document.getElementById("arquivoCartinha").files[0];
      const feedback = document.getElementById("feedbackCartinha").value.trim();
      let urlArquivo = null;

      if (arquivo) {
        const storageRef = storage.ref("cartinhas/" + Date.now() + "_" + arquivo.name);
        await storageRef.put(arquivo);
        urlArquivo = await storageRef.getDownloadURL();
      }

      if (!texto && !urlArquivo) {
        alert("Por favor, digite uma cartinha ou envie um arquivo.");
        return;
      }

      await database.ref("cartinhas").push({
        texto: texto || null,
        arquivo: urlArquivo || null,
        feedback: feedback || null,
        data: new Date().toISOString()
      });

      cartinhaForm.reset();
      alert("Cartinha enviada com sucesso! ðŸ’Œ");
    });

    database.ref("cartinhas").on("child_added", function(snapshot) {
      const cartinha = snapshot.val();
      const div = document.createElement("div");
      div.classList.add("cartinha");

      if (cartinha.texto) {
        div.innerHTML += `<p><strong>ðŸ“œ Cartinha:</strong><br>${cartinha.texto}</p>`;
      }

      if (cartinha.arquivo) {
        div.innerHTML += `<p>ðŸ“Ž <a href="${cartinha.arquivo}" target="_blank" rel="noopener noreferrer">Ver Arquivo</a></p>`;
      }

      if (cartinha.feedback) {
        div.innerHTML += `<p>ðŸ’¬ <i>Feedback:</i> "${cartinha.feedback}"</p>`;
      }

      cartinhasDiv.appendChild(div);
      <div style="margin-top: 20px;">
  <button onclick="window.location.href='conteudos.html'">
    ðŸ”™ Voltar para Bate-Papo e ConteÃºdos
  </button>
</div>
    });
  </script>
</body>
</html>
